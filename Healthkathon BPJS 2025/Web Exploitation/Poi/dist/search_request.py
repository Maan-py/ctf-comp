#!/usr/bin/env python3
"""
Simple script to send POST /search request with XML body
Based on the provided request format
"""

import requests

# Target configuration
HOST = "157.10.160.65"
PORT = 8088
URL = f"http://{HOST}:{PORT}/search"

# XML body
XML_BODY = """<!DOCTYPE search [ ]>
<search>
  <term>TES</term>
</search>"""

# Headers
headers = {
    "Host": f"{HOST}:{PORT}",
    "Content-Length": str(len(XML_BODY.encode('utf-8'))),
    "Accept-Language": "en-US,en;q=0.9",
    "User-Agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/142.0.0.0 Safari/537.36",
    "Content-Type": "application/xml",
    "Accept": "*/*",
    "Origin": f"http://{HOST}:{PORT}",
    "Referer": f"http://{HOST}:{PORT}/dashboard",
    "Accept-Encoding": "gzip, deflate, br",
    "Connection": "keep-alive"
}

# Cookies
cookies = {
    "session": "eyJsb2dnZWRfaW4iOnRydWUsInVzZXIiOiInIE9SIDE9MSAtLSJ9.aRhQtA.Swo36Nhv3leVGEAXoFCxM0u3tPA"
}

def send_request():
    """Send the POST request to /search"""
    try:
        print(f"[*] Sending POST request to {URL}")
        print(f"[*] XML Body:\n{XML_BODY}")
        print()
        
        response = requests.post(
            URL,
            data=XML_BODY,
            headers=headers,
            cookies=cookies,
            timeout=10
        )
        
        print(f"[+] Status Code: {response.status_code}")
        print(f"[+] Response Headers:")
        for key, value in response.headers.items():
            print(f"    {key}: {value}")
        print()
        print(f"[+] Response Body:")
        print(response.text)
        
        return response
        
    except requests.exceptions.RequestException as e:
        print(f"[-] Error: {e}")
        return None

if __name__ == "__main__":
    send_request()


