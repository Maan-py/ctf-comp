services:
  app:
    build: ./app
    environment:
      - SECRET_KEY=redacted
      - USERNAME=redacted
      - PASSWORD=redacted
      - FLAG=BPJS{redacted}

  webserver:
    build: ./nginx
    depends_on:
      - app

  cacheserver:
    build: ./smallcache
    ports:
      - "8081:8081"
    depends_on:
      - webserver

  qatest:
    build: ./qatest
    environment:
      - BASE_URL=http://cacheserver:8081
      - USERNAME=redacted
      - PASSWORD=redacted
    depends_on:
      - cacheserver